# PHP代码规范
## 基本代码规范
## 1. 概览

*   PHP代码文件 **必须** 以 `<?php` 或 `<?=` 标签开始；

*   PHP代码文件 **必须** 以 `不带 BOM 的 UTF-8` 编码；

*   PHP代码中 **应该** 只定义类、函数、常量等声明，或其他会产生 `副作用` 的操作（如：生成文件输出以及修改 .ini 配置文件等），二者只能选其一；

*   命名空间以及类 **必须** 符合 PSR 的自动加载规范：[PSR-4](https://learnku.com/docs/psr/psr-4-autoloader/1608) 中的一个；

*   类的命名 **必须** 遵循 `StudlyCaps` 大写开头的驼峰命名规范；

*   类中的常量所有字母都 **必须** 大写，单词间用下划线分隔；

*   方法名称 **必须** 符合 `camelCase` 式的小写开头驼峰命名规范。

## 2. 文件

### 2.1. PHP标签

PHP代码 **必须** 使用 `<?php ?>` 长标签 或 `<?= ?>` 短输出标签；
**一定不可** 使用其它自定义标签。

### 2.2. 字符编码

PHP代码 **必须** 且只可使用 `不带BOM的UTF-8` 编码。

### 2.3. 副作用

一份 PHP 文件中 **应该** 要不就只定义新的声明，如类、函数或常量等不产生 `副作用` 的操作，要不就只书写会产生 `副作用` 的逻辑操作，但 **不该** 同时具有两者。

「副作用」(side effects) 一词的意思是，仅仅通过包含文件，不直接声明类、函数和常量等，而执行的逻辑操作。

「副作用」包含却不仅限于：

*   生成输出
*   直接的 `require` 或 `include`
*   连接外部服务
*   修改 ini 配置
*   抛出错误或异常
*   修改全局或静态变量
*   读或写文件等

以下是一个 `反例`，一份包含「函数声明」以及产生「副作用」的代码：

    <?php
    // 「副作用」：修改 ini 配置
    ini_set('error_reporting', E_ALL);

    // 「副作用」：引入文件
    include "file.php";

    // 「副作用」：生成输出
    echo "<html>\n";

    // 声明函数
    function foo()
    {
        // 函数主体部分
    }

    下面是一个范例，一份只包含声明不产生「副作用」的代码：

    <?php
    // 声明函数
    function foo()
    {
        // 函数主体部分
    }

    // 条件声明 **不** 属于「副作用」
    if (! function_exists('bar')) {
        function bar()
        {
            // 函数主体部分
        }
    }

## 3. 命名空间和类

命名空间以及类的命名**必须**遵循 [PSR-4](https://learnku.com/docs/psr/psr-4-autoloader/1608)。

根据规范，每个类都独立为一个文件，且命名空间至少有一个层次：顶级的组织名称（vendor name）。

类的命名 **必须** 遵循 `StudlyCaps` 大写开头的驼峰命名规范。

PHP 5.3 及以后版本的代码 **必须** 使用正式的命名空间。

例如：

	<?php
    // PHP 5.3及以后版本的写法
    namespace Vendor\Model;

    class Foo
    {
    }

5.2.x 及之前的版本 **应该** 使用伪命名空间的写法，约定俗成使用顶级的组织名称（vendor name）如 `Vendor_` 为类前缀。

    <?php
    // 5.2.x及之前版本的写法
    class Vendor_Model_Foo
    {
    }

## 4. 类的常量、属性和方法

此处的「类」指代所有的类、接口以及可复用代码块（traits）。

### 4.1. 常量

类的常量中所有字母都 **必须** 大写，词间以下划线分隔。

    参照以下代码：

    <?php
    namespace Vendor\Model;

    class Foo
    {
        const VERSION = '1.0';
        const DATE_APPROVED = '2012-06-01';
    }

### 4.2. 属性

类的属性命名 **可以** 遵循：

*   大写开头的驼峰式 (`$StudlyCaps`)
*   小写开头的驼峰式 (`$camelCase`)
*   下划线分隔式 (`$under_score`)

不做强制要求，但无论遵循哪种命名方式，都 **应该** 在一定的范围内保持一致。

### 4.3. 方法

方法名称 **必须** 符合 `camelCase()` 式的小写开头驼峰命名规范。

--

## 编码风格规范
## 概览

*   代码 **必须** 遵循 `基本编码规范`。

*   代码 **必须** 使用4个空格符而不是「Tab 键」进行缩进。

*   每行的字符数 **应该** 软性保持在 80 个之内，理论上 **一定不可** 多于 120 个，但 **一定不可** 有硬性限制。

*   每个 `namespace` 命名空间声明语句和 `use` 声明语句块后面，**必须** 插入一个空白行。

*   类的开始花括号（`{`） **必须** 写在类声明后自成一行，结束花括号（`}`）也 **必须** 写在类主体后自成一行。

*   方法的开始花括号（`{`） **必须** 写在函数声明后自成一行，结束花括号（`}`）也 **必须** 写在函数主体后自成一行。

*   类的属性和方法 **必须** 添加访问修饰符（`private`、`protected` 以及 `public`），`abstract` 以及 `final` **必须** 声明在访问修饰符之前，而 `static` **必须** 声明在访问修饰符之后。

*   控制结构的关键字后 **必须** 要有一个空格符，而调用方法或函数时则 **一定不可** 有。

*   控制结构的开始花括号（`{`） **必须** 写在声明的同一行，而结束花括号（`}`） **必须** 写在主体后自成一行。

*   控制结构的开始左括号后和结束右括号前，都 **一定不可** 有空格符。

## 例子

以下例子程序简单地展示了以上大部分规范：

    <?php
    namespace Vendor\Package;

    use FooInterface;
    use BarClass as Bar;
    use OtherVendor\OtherPackage\BazClass;

    class Foo extends Bar implements FooInterface
    {
        public function sampleFunction($a, $b = null)
        {
            if ($a === $b) {
                bar();
            } elseif ($a > $b) {
                $foo->bar($arg1);
            } else {
                BazClass::bar($arg2, $arg3);
            }
        }

        final public static function bar()
        {
            // 方法的内容
        }
    }
--

## 代码注释规范
PHP里面常见的几种注释方式：

### 1.文件头的注释，介绍文件名，功能以及作者版本号等信息

```php
/** 
* 文件名简单介绍
* 
* 文件功能。 
* @author      alvin 作者
* @version     1.0 版本号
*/
```

### 2.函数的注释，函数作用，参数介绍及返回类型

```php
/**  
* 函数的含义说明 
* 
* @access public 
* @param mixed $arg1 参数一的说明 
* @param mixed $arg2 参数二的说明 
* @param mixed $mixed 这是一个混合类型 
* @return array 返回类型
*/ 
```
### 3.类的注释，类名及介绍

```
/** 
* 类的介绍 
* 
* 类的详细介绍（可选。）。 
* @author      alvin 作者 
* @version     1.0 版本号
*/ 
```

### 4.多行注释

```php
/* php注释语法
   这是多行注释。*/ 
```

### 5.单行注释

```php
$n = 10; //数量n，这是单行注释
```